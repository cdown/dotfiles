#!/bin/bash

shopt -s dotglob extglob globstar nullglob

git submodule update --init

if [[ $0 == /* ]]; then
    location=${0%/*}
else
    location=$PWD/${0#./}
    location=${location%/*}
fi

for file in "$location"/**/*; do
    bare="${file#$location/}"

    case "$bare" in
        ".git"|".git/"*|".gitignore"|setup) continue ;;
    esac

    if [[ -d "$file" ]]; then
        mkdir -p ~/"$bare"
    elif [[ -f "$file" ]]; then
        ln -sfn "$file" ~/"$bare"
    fi
done
