#!/bin/bash -e

time=$1

indices=$(pactl list short sources | awk '{print $1}')

echo "$indices" | xargs -I{} pactl set-source-mute {} 0
echo "$indices" | xargs -I{} pactl set-source-volume {} 100%
echo "Current microphone status:"
echo "$indices" | while read -r idx; do
    echo "Source $idx:"
    echo "  $(pactl get-source-mute $idx)"
    echo "  $(pactl get-source-volume $idx)"
done
if [[ $time ]]; then
    sleep "$time"
    mute-all-mics
fi
