inoremap <C-a> <Ins><C-a><Ins>

nnoremap : ;

nnoremap W :tabdetach<CR>
nnoremap u :undo<CR>
nnoremap x :tabonly<CR>
nnoremap C :source ~/.vimperatorrc<CR>
nnoremap H :history -max=50<CR>;o

qmark f https://facebook.com
qmark g https://gmail.com
qmark u https://unix.stackexchange.com
qmark t https://trello.com/b/GviPALDR/-
qmark h https://hangouts.google.com/
qmark r https://forecast.io
qmark d https://drive.google.com
qmark q https://quip.com
qmark x https://www.myfitnesspal.com/food/diary

" Enable search engine suggestions
set complete=Sl

" Do not focus input box on load
set focuscontent=true

set followhints=1
set yankencodedurl=true

set! accessibility.accesskeycausesactivation=false
set! browser.link.open_newwindow=1
set! browser.download.useDownloadDir=true
set! browser.download.folderList=1
set! browser.rights.3.shown=true
set! browser.startup.page=1
set! browser.tabs.warnOnClose=false
set! browser.tabs.warnOnCloseOtherTabs=false
set! browser.urlbar.doubleClickSelectsAll=false
set! extensions.hidtb.addtab_reopen=false
set! extensions.hidtb.auto_hide=true
set! extensions.hidtb.hide_delay=1000
set! extensions.hidtb.toggle_key=112
set! hidenavbar.autohide=true
set! hidenavbar.hideonstart=1
set! network.dnsCacheExpiration=0
set! reader.parse-on-load.enabled=false
set! signon.rememberSignons=false

" Not sure how, but even without the setting here ignorekeys seems to be sticky
between sessions, which causes state problems...
ignorekeys clear
ignorekeys add -except=o,O,B,b,C .*app.strigo.io.*
ignorekeys add -except=<Esc>,<C-o>,C,W,y,x,H,b,u,n,N,r,d,f,F,g,o,O,t,w,;,:,B,/ .*

sanitize cache downloads formdata history -timespan 3

" perf

set! browser.cache.memory.capacity=65536
set! browser.display.show_image_placeholders=false
set! browser.sessionhistory.max_total_viewers=0
set! browser.tabs.animate=false
set! config.trim_on_minimize=true
set! content.interrupt.parsing=true
set! content.max.tokenizing.time=2250000
set! content.notify.backoffcount=5
set! content.notify.interval=750000
set! content.notify.ontimer=true
set! content.switch.threshold=750000
set! general.smoothScroll=false
set! network.dns.disableIPv6=false
set! network.http.max-connections-per-server=16
set! network.http.max-connections=48
set! network.http.max-persistent-connections-per-proxy=16
set! network.http.max-persistent-connections-per-server=8
set! network.http.pipelining.aggressive=true
set! network.http.pipelining.maxrequests=8
set! network.http.pipelining.ssl=true
set! network.http.pipelining=true
set! network.http.proxy.pipelining=true
set! network.prefetch-next=true
set! nglayout.initialpaint.delay=0
set! plugin.expose_full_path=true
set! ui.submenuDelay=0

bmark https://www.google.co.uk/#q=%s -keyword=g
bmark http://dj.iciba.com/%s-1.html -keyword=dj
bmark https://www.mdbg.net/chindict/chindict.php?page=worddict&wdrst=0&wdqb=%s -keyword=zw

"javascript to hide statusbar
noremap ; :js toggle_bottombar('on')<CR>:
noremap o :js toggle_bottombar('on')<CR>o
noremap O :js toggle_bottombar('on')<CR>O
noremap t :js toggle_bottombar('on')<CR>t
noremap T :js toggle_bottombar('on')<CR>T
noremap / :js toggle_bottombar('on')<CR>/
noremap w :js toggle_bottombar('on')<CR>w
noremap b :js toggle_bottombar('on')<CR>b
cnoremap <CR> <CR>:js toggle_bottombar('off')<CR>
cnoremap <Esc> <Esc>:js toggle_bottombar('off')<CR>
noremap <Esc> <Esc>:js toggle_bottombar('off')<CR>
noremap B <Esc>:js toggle_bottombar('on')<CR>

:js << EOF
function toggle_bottombar(p) {
    var bb = document.getElementById('liberator-bottombar');
    if (!bb)
        return;
    if (p == 'on'){
        bb.style.height = '';
        bb.style.overflow = '';
        return;
    }
    if (p == 'off'){
        bb.style.height = '0px';
        bb.style.overflow = 'hidden';
        return;
    }
    bb.style.height = (bb.style.height == '') ? '0px' : '';
    bb.style.overflow = (bb.style.height == '') ? '' : 'hidden';
}
toggle_bottombar();
EOF

source! ~/.vimperatorrc.fb
